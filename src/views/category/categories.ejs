<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="stylesheet" type="text/css" href="/css/uploadimg.css">
    <link rel="stylesheet" type="text/css" href="/css/voucher.css">

    <style>
        .show {
            width: calc(var(--nav-width) + 156px);
        }

        .fileimagedata {
            display: flex;
            flex-wrap: nowrap;
            overflow-x: auto;
            position: absolute;
            left: 206px;
            top: -14px;
        }

        .fileimagedata img {
            padding: 14px;
            width: auto;
            height: 201px;
            margin: 5px;
            object-fit: cover;
        }

        .image-container {
            position: relative;
            margin: 5px;
        }

        .image-container img {
            max-width: 200px;
            height: 200px;
            display: block;

        }


        .delete-btn {
            position: absolute;
            top: -4px;
            right: 5px;
            background-color: #ff0000;
            color: #00ffa8;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
        }

        @import url("https://fonts.googleapis.com/css2?family=Inter:wght@100;400;500;900&display=swap");

        :root {
            --primary: #3df2e9;
            --secondary: rgb(243, 0, 85);
            --dark: #152026;
            --gray: #273640;
            --light: #6d808c;
        }



        #progress-bar-loading {
            position: relative;
            flex-wrap: nowrap;
            overflow-x: auto;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            color: var(--primary);
            outline: 4px solid var(--primary);
            outline-offset: -1px;
            left: 370px;
            bottom: 70px;
            align-items: center;
            display: none;
        }

        #progress-bar-loading::after,
        .number {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .number {
            font-size: 21px;
            font-weight: bold;
        }

        .circle {
            stroke: var(--secondary);
            stroke-dasharray: 410;
            stroke-dashoffset: 410;
            animation: barFill 5s linear forwards;
            transform: rotate(-90deg);
        }

        @keyframes barFill {
            100% {
                stroke-dashoffset: 0;
            }
        }
    </style>
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <!-- Font-icon css-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css">
    <!-- or -->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@latest/css/boxicons.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.2/jquery-confirm.min.css">
    <link rel="stylesheet" type="text/css"
        href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script type="text/javascript" src="/ckeditor/ckeditor.js"></script>
    <link rel="stylesheet" type="text/css" href="/css/uploadimg.css">
    <style>
        .show {
            width: calc(var(--nav-width) + 156px);
        }
    </style>

</head>

<body id="page-top">
    <div id="wrapper">
        <!-- Sidebar -->
        <ul class="navbar-nav sidebar sidebar-light accordion" id="accordionSidebar">
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="/">
                <div class="sidebar-brand-icon">
                    <img src="/img/logo/logo.png">
                </div>
                <div class="sidebar-brand-text mx-3" style="font-weight: 500;" style="font-weight: 500;">Sneaker Nike
                    Store</div>
            </a>
            <hr class="sidebar-divider my-0">
            <li class="nav-item ">
                <a class="nav-link" href="/admin/dashboard">
                    <i class="fas fa-fw fa-tachometer-alt"></i>
                    <span>Dashboard</span></a>
            </li>
            <hr class="sidebar-divider">
            <div class="sidebar-heading">
                Features
            </div>
            <li class="nav-item ">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseBootstrap"
                    aria-expanded="true" aria-controls="collapseBootstrap">
                    <i class="fab fa-product-hunt" style="font-size: 20px;"></i>
                    <span>Quản lý sản phẩm</span>
                </a>
                <div id="collapseBootstrap" class="collapse" aria-labelledby="headingBootstrap"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Products Manager</h6>
                        <a class="collapse-item " href="/admin/products">Danh sách sản phẩm</a>
                        <a class="collapse-item" href="/admin/products/create">Thêm Sản phẩm</a>
                    </div>
                </div>
            </li>
            <li class="nav-item active">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#categoryclick"
                    aria-expanded="true" aria-controls="categoryclick">
                    <!-- Different icon for "Quản lý Danh mục" -->
                    <img src="https://icons.veryicon.com/png/o/miscellaneous/fangshan-design_icon/category-18.png"
                        style="width: 20px; height: 20px;">
                    <span>Quản lý Danh mục</span>
                </a>
                <div id="categoryclick" class="collapse" aria-labelledby="headingBootstrap"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Danh sách danh mục</h6>
                        <a class="collapse-item active" href="/admin/categories">Danh sách danh mục</a>
                        <!-- <a class="collapse-item" href="/admin/voucher/create">Thêm Voucher</a> -->
                    </div>
                </div>
            </li>
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#customerManager"
                    aria-expanded="true" aria-controls="customerManager">
                    <i class="fa fa-user" style="font-size: 20px;"></i>
                    <span>Quản lý người dùng</span>
                </a>
                <div id="customerManager" class="collapse" aria-labelledby="headingBootstrap"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Quản lý người dùng</h6>
                        <a class="collapse-item" href="/admin/users">Danh sách khách hàng</a>
                    </div>
                </div>
            </li>
            <li class="nav-item ">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#discountsclick"
                    aria-expanded="true" aria-controls="discountsclick">
                    <img src="https://cdn-icons-png.flaticon.com/512/1874/1874938.png"
                        style="width: 20px; height: 20px;">
                    <span>Quản lý Voucher</span>
                </a>
                <div id="discountsclick" class="collapse" aria-labelledby="headingBootstrap"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Vouchers Manager</h6>
                        <a class="collapse-item" href="/admin/voucher/">Danh sách Voucher</a>
                        <a class="collapse-item" href="/admin/voucher/create">Thêm Voucher</a>
                    </div>
                </div>
            </li>
            <li class="nav-item ">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#orderclick"
                    aria-expanded="true" aria-controls="orderclick">
                    <img src="https://icons.veryicon.com/png/o/miscellaneous/icondian/icon-order-1.png"
                        style="width: 20px; height: 20px;">
                    <span>Quản lý đơn hàng</span>
                </a>
                <div id="orderclick" class="collapse" aria-labelledby="headingBootstrap"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Quản lý đơn hàng</h6>
                        <a class="collapse-item " href="/admin/orders/">Danh sách đơn hàng</a>
                        <!-- <a class="collapse-item" href="/admin/voucher/create">Thêm Voucher</a> -->
                    </div>
                </div>
            </li>
            <li class="nav-item ">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#analyticclick"
                    aria-expanded="true" aria-controls="analyticclick">
                    <img src="https://iili.io/JI7mMbI.png" style="width: 20px; height: 20px;">
                    <span>Báo cáo</span>
                </a>
                <div id="analyticclick" class="collapse" aria-labelledby="headingBootstrap"
                    data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <h6 class="collapse-header">Doanh thu</h6>
                        <a class="collapse-ite" href="/admin/analytic/">Doanh thu bán hàng</a>
                        <!-- <a class="collapse-item" href="/admin/voucher/create">Thêm Voucher</a> -->
                    </div>
                </div>
            </li>
            <hr class="sidebar-divider">
            <hr class="sidebar-divider">
            <div class="version" id="version-ruangadmin"></div>
        </ul>
        <!-- Sidebar -->
        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <!-- TopBar -->
                <nav class="navbar navbar-expand navbar-light bg-navbar topbar mb-4 static-top">
                    <button id="sidebarToggleTop" class="btn btn-link rounded-circle mr-3">
                        <i class="fa fa-bars"></i>
                    </button>
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item dropdown no-arrow">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <img class="img-profile rounded-circle"
                                    src="https://images.rawpixel.com/image_png_800/cHJpdmF0ZS9sci9pbWFnZXMvd2Vic2l0ZS8yMDIyLTA0L3BmLWljb240LWppcjIwNjItcG9yLWwtam9iNzg4LnBuZw.png"
                                    style="max-width: 60px">
                                <span class="ml-2 d-none d-lg-inline text-white small">MD-02 Fall 2023</span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right shadow animated--grow-in"
                                aria-labelledby="userDropdown">
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-user fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Profile
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-cogs fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Settings
                                </a>
                                <a class="dropdown-item" href="#">
                                    <i class="fas fa-list fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Activity Log
                                </a>
                                <div class="dropdown-divider"></div>
                                <a class="dropdown-item" href="javascript:void(0);" data-toggle="modal"
                                    data-target="#logoutModal">
                                    <i class="fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"></i>
                                    Logout
                                </a>
                            </div>
                        </li>
                    </ul>
                </nav>
                <!-- Topbar -->

                <!-- Container Fluid-->
                <div class="container-fluid" id="container-wrapper">
                    <div class="d-sm-flex align-items-center justify-content-between mb-4">
                        <h1 class="h3 mb-0 text-gray-800">Danh mục</h1>

                    </div>
                    <div class="row">
                        <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet"
                            id="bootstrap-css">
                        <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
                        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
                        <!------ Include the above in your HEAD tag ---------->

                        <script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
                        <script src="https://cdn.datatables.net/1.10.16/js/dataTables.bootstrap4.min.js"></script>

                        <div class="containerss">
                            <div class="row">
                                <table id="example" class="table table-striped table-bordered" style="width:100%">
                                    <thead>
                                        <tr>
                                            <th><input type="checkbox" onclick="checkAll(this)"></th>
                                            <th>Id</th>
                                            <th>Tên</th>
                                            <th>Ảnh</th>
                                            <th>Quản lý</th>

                                    </thead>
                                    <tbody>
                                        <% categories.forEach((category, index)=> { %>
                                            <tr>
                                                <td><input type="checkbox" name=""></td>
                                                <td>
                                                    <%= category.category_id %>
                                                </td>
                                                <td>
                                                    <%= category.name %>
                                                </td>
                                                <td> <img src="<%= category.image %>" class="img-fluid"
                                                        style="width: 100px; height: 100px; resize: unset;"></td>
                                                <td>
                                                    <a href="/admin/categories/edit/<%= category.category_id%>"
                                                        class="btn btn-primary btn-sm"
                                                        style="width: auto;height: auto;">Sửa</a>
                                                </td>
                                            </tr>

                                            <% }) %>

                                    </tbody>

                                </table>
                            </div>
                        </div>
                        <!---Container Fluid-->
                    </div>

                    <!-- Footer -->
                    <footer class="sticky-footer bg-white">
                        <div class="container my-auto">
                            <div class="copyright text-center my-auto">
                                <span>copyright &copy;
                                    <script> document.write(new Date().getFullYear()); </script> - developed by
                                    <b><a href="https://github.com/ShopBanGiayUIMY" target="_blank">MD-02 Fall
                                            2023</a></b>
                                </span>
                            </div>
                        </div>
                    </footer>

                </div>
            </div>
            <!-- Scrollto to top -->
            <a class="scroll-to-top rounded" href="#page-top">
                <i class="fas fa-angle-up"></i>
            </a>
            <script src="vendor/jquery/jquery.min.js"></script>
            <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
            <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
            <script src="js/ruang-admin.min.js"></script>
            <!-- 
      // upload Ảnh -->
            <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
            <script>


                const number = document.querySelector(".number");
                const valueNumber = Number(number.getAttribute("data-value"));
                const circle = document.querySelector('.circle');
                const progressBar = document.getElementById('progress-bar-loading');
                const uploadedImagesDiv = document.querySelector('.fileimagedata');
                const fileInput = document.getElementById('file-input');
                let counter = 0;

                const loading = (results) => {
                    uploadedImagesDiv.style.display = 'none';
                    counter = 0;
                    const interval = setInterval(() => {
                        if (counter !== valueNumber) {
                            counter++;
                            number.innerHTML = `${counter}%`;
                        } else {
                            if (counter === 100) {
                                clearInterval(interval);
                                circle.style.animation = 'none';
                                progressBar.style.display = 'none';
                                fileInput.value = '';
                                uploadedImagesDiv.style.display = 'flex';
                                counter = 0;

                            }
                        }
                    }, 50);
                };

                function selectImage() {
                    const fileInput = document.querySelector('.inp');
                    fileInput.click();
                    counter = 0; // Đặt lại counter về 0
                    circle.style.animation = 'none'; // Đặt lại animation về trạng thái ban đầu
                    progressBar.style.display = 'none'; // Ẩn thanh tiến trình
                }
                function checkIfFileSelected() {
                    if (fileInput.files.length > 0) {
                        uploadImages();
                    } else {
                        console.log('Chưa chọn file.');
                    }
                }
                function uploadImages() {
                    const files = fileInput.files;
                    const apiKey = 'ced7232acd31a71dd12d79e489cd4f30';

                    const uploadPromises = [];

                    for (let i = 0; i < files.length; i++) {
                        const formData = new FormData();
                        formData.append('image', files[i]);
                        formData.append('key', apiKey);

                        const promise = new Promise((resolve, reject) => {
                            axios.post('https://api.imgbb.com/1/upload', formData)
                                .then(response => {
                                    console.log(response.data);
                                    resolve(response.data);
                                    circle.style.animation = '';
                                    progressBar.style.display = 'block';
                                    uploadedImagesDiv.style.display = 'none';
                                    console.log('Đã tải lên dsssssssssssssssảnh:', counter);
                                })
                                .catch(error => {
                                    console.error('Lỗi:', error);
                                    reject(error);
                                });
                        });

                        uploadPromises.push(promise);
                    }

                    Promise.all(uploadPromises)
                        .then(results => {
                            loading();
                            const dataOnly = results.map(item => JSON.stringify(item.data.url));
                            console.log('Tất cả ảnh đã được tải lên:', dataOnly);
                            const jsonInput = document.getElementById('product_image');
                            jsonInput.value = dataOnly;
                            results.forEach(imageData => {
                                const imageDiv = document.createElement('div');
                                imageDiv.classList.add('image-container');

                                const imageUrl = imageData.data.url;
                                const img = document.createElement('img');
                                img.src = imageUrl;
                                imageDiv.appendChild(img);

                                const deleteBtn = document.createElement('button');
                                deleteBtn.innerText = 'X';
                                deleteBtn.classList.add('delete-btn');
                                deleteBtn.addEventListener('click', function () {
                                    imageDiv.remove();
                                    console.log('Xóa ảnh với ID:', imageData.data.id);
                                });
                                imageDiv.appendChild(deleteBtn);

                                uploadedImagesDiv.appendChild(imageDiv);

                            });
                        })
                        .catch(error => {
                            console.error('Có lỗi khi tải lên ảnh:', error);
                        });
                }
            </script>
</body>

</html>